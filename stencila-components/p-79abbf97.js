import{D as t,b as i,N as s,T as e,v as h,w as r}from"./p-6c5c4643.js";class n{constructor(t,i,s,e,h,r,n,l,f,o){this.p=t,this.stack=i,this.state=s,this.reducePos=e,this.pos=h,this.score=r,this.buffer=n,this.bufferBase=l,this.curContext=f,this.parent=o}toString(){return`[${this.stack.filter(((t,i)=>i%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,i,s=0){let e=t.parser.context;return new n(t,[],i,s,s,0,[],0,e?new l(e,e.start):null,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,i){this.stack.push(this.state,i,this.bufferBase+this.buffer.length),this.state=t}reduce(t){let i=t>>19,s=65535&t,{parser:e}=this.p,h=e.dynamicPrecedence(s);if(h&&(this.score+=h),0==i)return s<e.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,4,!0),this.pushState(e.getGoto(this.state,s,!0),this.reducePos),void this.reduceContext(s);let r=this.stack.length-3*(i-1)-(262144&t?6:0),n=this.stack[r-2],l=this.bufferBase+this.buffer.length-this.stack[r-1];if(s<e.minRepeatTerm||131072&t){let t=e.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,n,t,l+4,!0)}for(this.state=262144&t?this.stack[r]:e.getGoto(this.stack[r-3],s,!0);this.stack.length>r;)this.stack.pop();this.reduceContext(s)}storeNode(t,i,s,e=4,h=!1){if(0==t){let t=this,e=this.buffer.length;if(0==e&&t.parent&&(e=t.bufferBase-t.parent.bufferBase,t=t.parent),e>0&&0==t.buffer[e-4]&&t.buffer[e-1]>-1){if(i==s)return;if(t.buffer[e-2]>=i)return void(t.buffer[e-2]=s)}}if(h&&this.pos!=s){let h=this.buffer.length;if(h>0&&0!=this.buffer[h-4])for(;h>0&&this.buffer[h-2]>s;)this.buffer[h]=this.buffer[h-4],this.buffer[h+1]=this.buffer[h-3],this.buffer[h+2]=this.buffer[h-2],this.buffer[h+3]=this.buffer[h-1],h-=4,e>4&&(e-=4);this.buffer[h]=t,this.buffer[h+1]=i,this.buffer[h+2]=s,this.buffer[h+3]=e}else this.buffer.push(t,i,s,e)}shift(t,i,s){if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){let e=this.pos,h=t,{parser:r}=this.p;(s>this.pos||i<=r.maxNode)&&(this.pos=s,r.stateFlag(h,1)||(this.reducePos=s)),this.pushState(h,e),i<=r.maxNode&&this.buffer.push(i,e,s,4),this.shiftContext(i)}else i<=this.p.parser.maxNode&&this.buffer.push(i,this.pos,s,4),this.pos=s}apply(t,i,s){65536&t?this.reduce(t):this.shift(t,i,s)}useNode(t,i){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=t)&&(this.p.reused.push(t),s++);let e=this.pos;this.reducePos=this.pos=e+t.length,this.pushState(i,e),this.buffer.push(s,e,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this.p.input,this))}split(){let t=this,i=t.buffer.length;for(;i>0&&t.buffer[i-2]>t.reducePos;)i-=4;let s=t.buffer.slice(i),e=t.bufferBase+i;for(;t&&e==t.bufferBase;)t=t.parent;return new n(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,e,this.curContext,t)}recoverByDelete(t,i){let s=t<=this.p.parser.maxNode;s&&this.storeNode(t,this.pos,i),this.storeNode(0,this.pos,i,s?8:4),this.pos=this.reducePos=i,this.score-=200}canShift(t){for(let i=new o(this);;){let s=this.p.parser.stateSlot(i.top,4)||this.p.parser.hasAction(i.top,t);if(0==(65536&s))return!0;if(0==s)return!1;i.reduce(s)}}get ruleStart(){for(let t=this.state,i=this.stack.length;;){let s=this.p.parser.stateSlot(t,5);if(!(65536&s))return 0;if(i-=3*(s>>19),(65535&s)<this.p.parser.minRepeatTerm)return this.stack[i+1];t=this.stack[i]}}startOf(t,i){let s=this.state,e=this.stack.length,{parser:h}=this.p;for(;;){let r=h.stateSlot(s,5),n=r>>19,l=65535&r;if(t.indexOf(l)>-1){let t=this.stack[e-3*(r>>19)+1];if(null==i||i>t)return t}if(0==e)return null;0==n?(e-=3,s=this.stack[e]):(e-=3*(n-1),s=h.getGoto(this.stack[e-3],l,!0))}}recoverByInsert(t){if(this.stack.length>=300)return[];let i=this.p.parser.nextStates(this.state);if(i.length>8||this.stack.length>=120){let s=[];for(let e,h=0;h<i.length;h+=2)(e=i[h+1])!=this.state&&this.p.parser.hasAction(e,t)&&s.push(i[h],e);if(this.stack.length<120)for(let t=0;s.length<8&&t<i.length;t+=2){let e=i[t+1];s.some(((t,i)=>1&i&&t==e))||s.push(i[t],e)}i=s}let s=[];for(let e=0;e<i.length&&s.length<4;e+=2){let t=i[e+1];if(t==this.state)continue;let h=this.split();h.storeNode(0,h.pos,h.pos,4,!0),h.pushState(t,this.pos),h.shiftContext(i[e]),h.score-=200,s.push(h)}return s}forceReduce(){let t=this.p.parser.stateSlot(this.state,5);return 0!=(65536&t)&&(this.p.parser.validAction(this.state,t)||(this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100),this.reduce(t),!0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2)&&this.forceReduce(););return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let i=0;i<this.stack.length;i+=3)if(this.stack[i]!=t.stack[i])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this.p.input,this))}reduceContext(t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this.p.input,this))}emitContext(){let t=this.curContext;if(!t.tracker.strict)return;let i=this.buffer.length-1;(i<0||-2!=this.buffer[i])&&this.buffer.push(t.hash,this.reducePos,this.reducePos,-2)}updateContext(t){if(t!=this.curContext.context){let i=new l(this.curContext.tracker,t);i.hash!=this.curContext.hash&&this.emitContext(),this.curContext=i}}}class l{constructor(t,i){this.tracker=t,this.context=i,this.hash=t.hash(i)}}var f;!function(t){t[t.Token=200]="Token",t[t.Reduce=100]="Reduce",t[t.MaxNext=4]="MaxNext",t[t.MaxInsertStackDepth=300]="MaxInsertStackDepth",t[t.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(f||(f={}));class o{constructor(t){this.stack=t,this.top=t.state,this.rest=t.stack,this.offset=this.rest.length}reduce(t){let i=65535&t,s=t>>19;0==s?(this.rest==this.stack.stack&&(this.rest=this.rest.slice()),this.rest.push(this.top,0,0),this.offset+=3):this.offset-=3*(s-1);let e=this.stack.p.parser.getGoto(this.rest[this.offset-3],i,!0);this.top=e}}class u{constructor(t,i,s){this.stack=t,this.pos=i,this.index=s,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t){return new u(t,t.bufferBase+t.buffer.length,t.buffer.length)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new u(this.stack,this.pos,this.index)}}class a{constructor(){this.start=-1,this.value=-1,this.end=-1}accept(t,i){this.value=t,this.end=i}}class c{constructor(t,i){this.data=t,this.id=i}token(t,i,s){!function(t,i,s,e,h){let r=0,n=1<<h,l=e.p.parser.dialect;t:for(let f=s.start;0!=(n&t[r]);){let h=t[r+1];for(let i=r+3;i<h;i+=2)if((t[i+1]&n)>0){let h=t[i];if(l.allows(h)&&(-1==s.value||s.value==h||e.p.parser.overrides(h,s.value))){s.accept(h,f);break}}let o=i.get(f++);for(let i=0,s=t[r+2];i<s;){let e=i+s>>1,n=h+e+(e<<1),l=t[n+1];if(o<t[n])s=e;else{if(!(o>=l)){r=t[n+2];continue t}i=e+1}}break}}(this.data,t,i,s,this.id)}}c.prototype.contextual=c.prototype.fallback=c.prototype.extend=!1;class d{constructor(t,i={}){this.token=t,this.contextual=!!i.contextual,this.fallback=!!i.fallback,this.extend=!!i.extend}}function p(t,i=Uint16Array){if("string"!=typeof t)return t;let s=null;for(let e=0,h=0;e<t.length;){let r=0;for(;;){let i=t.charCodeAt(e++),s=!1;if(126==i){r=65535;break}i>=92&&i--,i>=34&&i--;let h=i-32;if(h>=46&&(h-=46,s=!0),r+=h,s)break;r*=46}s?s[h++]=r:s=new i(r)}return s}const w="undefined"!=typeof process&&/\bparse\b/.test(process.env.LOG);let k=null;function v(t,i,s){let e=t.cursor(i);for(;;)if(!(s<0?e.childBefore(i):e.childAfter(i)))for(;;){if((s<0?e.to<=i:e.from>=i)&&!e.type.isError)return s<0?Math.max(0,Math.min(e.to-1,i-5)):Math.min(t.length,Math.max(e.from+1,i+5));if(s<0?e.prevSibling():e.nextSibling())break;if(!e.parent())return s<0?0:t.length}}class g{constructor(t){this.fragments=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?v(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?v(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let i=this.trees.length-1;if(i<0)return this.nextFragment(),null;let s=this.trees[i],e=this.index[i];if(e==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let h=s.children[e],n=this.start[i]+s.positions[e];if(n>t)return this.nextStart=n,null;if(n==t&&n+h.length<=this.safeTo)return n==t&&n>=this.safeFrom?h:null;h instanceof r?(this.index[i]++,this.nextStart=n+h.length):(this.index[i]++,n+h.length>=t&&(this.trees.push(h),this.start.push(n),this.index.push(0)))}}}class b extends a{constructor(){super(...arguments),this.extended=-1,this.mask=0,this.context=0}clear(t){this.start=t,this.value=this.extended=-1}}const m=new a;class y{constructor(t){this.tokens=[],this.mainToken=m,this.actions=[],this.tokens=t.tokenizers.map((()=>new b))}getActions(t,i){let s=0,e=null,{parser:h}=t.p,{tokenizers:r}=h,n=h.stateSlot(t.state,3),l=t.curContext?t.curContext.hash:0;for(let f=0;f<r.length;f++){if(0==(1<<f&n))continue;let h=r[f],o=this.tokens[f];if((!e||h.fallback)&&((h.contextual||o.start!=t.pos||o.mask!=n||o.context!=l)&&(this.updateCachedToken(o,h,t,i),o.mask=n,o.context=l),0!=o.value)){let i=s;if(o.extended>-1&&(s=this.addActions(t,o.extended,o.end,s)),s=this.addActions(t,o.value,o.end,s),!h.extend&&(e=o,s>i))break}}for(;this.actions.length>s;)this.actions.pop();return e||(e=m,e.start=t.pos,t.pos==i.length?e.accept(t.p.parser.eofTerm,t.pos):e.accept(0,t.pos+1)),this.mainToken=e,this.actions}updateCachedToken(t,i,s,e){if(t.clear(s.pos),i.token(e,t,s),t.value>-1){let{parser:i}=s.p;for(let h=0;h<i.specialized.length;h++)if(i.specialized[h]==t.value){let r=i.specializers[h](e.read(t.start,t.end),s);if(r>=0&&s.p.parser.dialect.allows(r>>1)){0==(1&r)?t.value=r>>1:t.extended=r>>1;break}}}else s.pos==e.length?t.accept(s.p.parser.eofTerm,s.pos):t.accept(0,s.pos+1)}putAction(t,i,s,e){for(let h=0;h<e;h+=3)if(this.actions[h]==t)return e;return this.actions[e++]=t,this.actions[e++]=i,this.actions[e++]=s,e}addActions(t,i,s,e){let{state:h}=t,{parser:r}=t.p,{data:n}=r;for(let l=0;l<2;l++)for(let t=r.stateSlot(h,l?2:1);;t+=3){if(65535==n[t]){if(1!=n[t+1]){0==e&&2==n[t+1]&&(e=this.putAction(R(n,t+1),i,s,e));break}t=R(n,t+2)}n[t]==i&&(e=this.putAction(R(n,t+1),i,s,e))}return e}}var x;!function(t){t[t.Distance=5]="Distance",t[t.MaxRemainingPerStep=3]="MaxRemainingPerStep",t[t.MinBufferLengthPrune=200]="MinBufferLengthPrune",t[t.ForceReduceLimit=10]="ForceReduceLimit"}(x||(x={}));class S{constructor(t,i,s,e){this.parser=t,this.input=i,this.startPos=s,this.context=e,this.pos=0,this.recovering=0,this.nextStackID=9812,this.nested=null,this.nestEnd=0,this.nestWrap=null,this.reused=[],this.tokens=new y(t),this.topTerm=t.top[1],this.stacks=[n.start(this,t.top[0],this.startPos)];let h=null==e?void 0:e.fragments;this.fragments=h&&h.length?new g(h):null}advance(){if(this.nested){let t=this.nested.advance();return this.pos=this.nested.pos,t&&(this.finishNested(this.stacks[0],t),this.nested=null),null}let t,i,s,e=this.stacks,h=this.pos,r=this.stacks=[];for(let n=0;n<e.length;n++){let l,f=e[n];for(;;){if(f.pos>h)r.push(f);else if(l=this.checkNest(f))(!s||s.stack.score<f.score)&&(s=l);else{if(this.advanceStack(f,r,e))continue;{t||(t=[],i=[]),t.push(f);let s=this.tokens.mainToken;i.push(s.value,s.end)}}break}}if(s)return this.startNested(s),null;if(!r.length){let i=t&&function(t){let i=null;for(let s of t)s.pos==s.p.input.length&&s.p.parser.stateFlag(s.state,2)&&(!i||i.score<s.score)&&(i=s);return i}(t);if(i)return this.stackToTree(i);if(this.parser.strict)throw w&&t&&console.log("Stuck with token "+this.parser.getName(this.tokens.mainToken.value)),new SyntaxError("No parse at "+h);this.recovering||(this.recovering=5)}if(this.recovering&&t){let s=this.runRecovery(t,i,r);if(s)return this.stackToTree(s.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(r.length>t)for(r.sort(((t,i)=>i.score-t.score));r.length>t;)r.pop();r.some((t=>t.reducePos>h))&&this.recovering--}else if(r.length>1)t:for(let n=0;n<r.length-1;n++){let t=r[n];for(let i=n+1;i<r.length;i++){let s=r[i];if(t.sameState(s)||t.buffer.length>200&&s.buffer.length>200){if(!((t.score-s.score||t.buffer.length-s.buffer.length)>0)){r.splice(n--,1);continue t}r.splice(i--,1)}}}this.pos=r[0].pos;for(let n=1;n<r.length;n++)r[n].pos<this.pos&&(this.pos=r[n].pos);return null}advanceStack(t,i,s){let h=t.pos,{input:r,parser:n}=this,l=w?this.stackID(t)+" -> ":"";if(this.fragments){let i=t.curContext&&t.curContext.tracker.strict,s=i?t.curContext.hash:0;for(let r=this.fragments.nodeAt(h);r;){let h=this.parser.nodeSet.types[r.type.id]==r.type?n.getGoto(t.state,r.type.id):-1;if(h>-1&&r.length&&(!i||(r.contextHash||0)==s))return t.useNode(r,h),w&&console.log(l+this.stackID(t)+` (via reuse of ${n.getName(r.type.id)})`),!0;if(!(r instanceof e)||0==r.children.length||r.positions[0]>0)break;let f=r.children[0];if(!(f instanceof e))break;r=f}}let f=n.stateSlot(t.state,4);if(f>0)return t.reduce(f),w&&console.log(l+this.stackID(t)+` (via always-reduce ${n.getName(65535&f)})`),!0;let o=this.tokens.getActions(t,r);for(let e=0;e<o.length;){let r=o[e++],f=o[e++],u=o[e++],a=e==o.length||!s,c=a?t:t.split();if(c.apply(r,f,u),w&&console.log(l+this.stackID(c)+` (via ${0==(65536&r)?"shift":`reduce of ${n.getName(65535&r)}`} for ${n.getName(f)} @ ${h}${c==t?"":", split"})`),a)return!0;c.pos>h?i.push(c):s.push(c)}return!1}advanceFully(t,i){let s=t.pos;for(;;){let e=this.checkNest(t);if(e)return e;if(!this.advanceStack(t,null,null))return!1;if(t.pos>s)return N(t,i),!0}}runRecovery(t,i,s){let e,h=null,r=!1;for(let n=0;n<t.length;n++){let l=t[n],f=i[n<<1],o=i[1+(n<<1)],u=w?this.stackID(l)+" -> ":"";if(l.deadEnd){if(r)continue;r=!0,l.restart(),w&&console.log(u+this.stackID(l)+" (restarted)");let t=this.advanceFully(l,s);if(t){!0!==t&&(e=t);continue}}let a=l.split(),c=u;for(let t=0;a.forceReduce()&&t<10;t++){w&&console.log(c+this.stackID(a)+" (via force-reduce)");let t=this.advanceFully(a,s);if(t){!0!==t&&(e=t);break}w&&(c=this.stackID(a)+" -> ")}for(let t of l.recoverByInsert(f))w&&console.log(u+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,s);this.input.length>l.pos?(o==l.pos&&(o++,f=0),l.recoverByDelete(f,o),w&&console.log(u+this.stackID(l)+` (via recover-delete ${this.parser.getName(f)})`),N(l,s)):(!h||h.score<l.score)&&(h=l)}if(h)return h;if(e)for(let n of this.stacks)if(n.score>e.stack.score){e=void 0;break}return e&&this.startNested(e),null}forceFinish(){let t=this.stacks[0].split();return this.nested&&this.finishNested(t,this.nested.forceFinish()),this.stackToTree(t.forceAll())}stackToTree(t,i=t.pos){return this.parser.context&&t.emitContext(),e.build({buffer:u.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.startPos,length:i-this.startPos,minRepeatType:this.parser.minRepeatTerm})}checkNest(t){let i=this.parser.findNested(t.state);if(!i)return null;let s=i.value;return"function"==typeof s&&(s=s(this.input,t)),s?{stack:t,info:i,spec:s}:null}startNested(t){let{stack:i,info:s,spec:e}=t;this.stacks=[i],this.nestEnd=this.scanForNestEnd(i,s.end,e.filterEnd),this.nestWrap="number"==typeof e.wrapType?this.parser.nodeSet.types[e.wrapType]:e.wrapType||null,e.startParse?this.nested=e.startParse(this.input.clip(this.nestEnd),i.pos,this.context):this.finishNested(i)}scanForNestEnd(t,i,s){for(let e=t.pos;e<this.input.length;e++)if(m.start=e,m.value=-1,i.token(this.input,m,t),m.value>-1&&(!s||s(this.input.read(e,m.end))))return e;return this.input.length}finishNested(t,i){this.nestWrap?i=new e(this.nestWrap,i?[i]:[],i?[0]:[],this.nestEnd-t.pos):i||(i=new e(s.none,[],[],this.nestEnd-t.pos));let h=this.parser.findNested(t.state);t.useNode(i,this.parser.getGoto(t.state,h.placeholder,!0)),w&&console.log(this.stackID(t)+" (via unnest)")}stackID(t){let i=(k||(k=new WeakMap)).get(t);return i||k.set(t,i=String.fromCodePoint(this.nextStackID++)),i+t}}function N(t,i){for(let s=0;s<i.length;s++){let e=i[s];if(e.pos==t.pos&&e.sameState(t))return void(i[s].score<t.score&&(i[s]=t))}i.push(t)}class ${constructor(t,i,s){this.source=t,this.flags=i,this.disabled=s}allows(t){return!this.disabled||0==this.disabled[t]}}const A=t=>t;class D{constructor(t){this.start=t.start,this.shift=t.shift||A,this.reduce=t.reduce||A,this.reuse=t.reuse||A,this.hash=t.hash,this.strict=!1!==t.strict}}class M{constructor(e){if(this.bufferLength=t,this.strict=!1,this.cachedDialect=null,13!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (13)`);let h=p(e.tokenData),r=e.nodeNames.split(" ");this.minRepeatTerm=r.length,this.context=e.context;for(let t=0;t<e.repeatNodeCount;t++)r.push("");let n=[];for(let t=0;t<r.length;t++)n.push([]);function l(t,i,s){n[t].push([i,i.deserialize(String(s))])}if(e.nodeProps)for(let t of e.nodeProps){let i=t[0];for(let s=1;s<t.length;){let e=t[s++];if(e>=0)l(e,i,t[s++]);else{let h=t[s+-e];for(let r=-e;r>0;r--)l(t[s++],i,h);s++}}}if(this.specialized=new Uint16Array(e.specialized?e.specialized.length:0),this.specializers=[],e.specialized)for(let t=0;t<e.specialized.length;t++)this.specialized[t]=e.specialized[t].term,this.specializers[t]=e.specialized[t].get;this.states=p(e.states,Uint32Array),this.data=p(e.stateData),this.goto=p(e.goto);let f=Object.keys(e.topRules).map((t=>e.topRules[t][1]));this.nodeSet=new i(r.map(((t,i)=>s.define({name:i>=this.minRepeatTerm?void 0:t,id:i,props:n[i],top:f.indexOf(i)>-1,error:0==i,skipped:e.skippedNodes&&e.skippedNodes.indexOf(i)>-1})))),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((t=>"number"==typeof t?new c(h,t):t)),this.topRules=e.topRules,this.nested=(e.nested||[]).map((([t,i,s,e])=>({name:t,value:i,end:new c(p(s),0),placeholder:e}))),this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}parse(t,i=0,s={}){"string"==typeof t&&(t=h(t));let e=new S(this,t,i,s);for(;;){let t=e.advance();if(t)return t}}startParse(t,i=0,s={}){return"string"==typeof t&&(t=h(t)),new S(this,t,i,s)}getGoto(t,i,s=!1){let e=this.goto;if(i>=e[0])return-1;for(let h=e[i+1];;){let i=e[h++],r=1&i,n=e[h++];if(r&&s)return n;for(let s=h+(i>>1);h<s;h++)if(e[h]==t)return n;if(r)return-1}}hasAction(t,i){let s=this.data;for(let e=0;e<2;e++)for(let h,r=this.stateSlot(t,e?2:1);;r+=3){if(65535==(h=s[r])){if(1!=s[r+1]){if(2==s[r+1])return R(s,r+2);break}h=s[r=R(s,r+2)]}if(h==i||0==h)return R(s,r+1)}return 0}stateSlot(t,i){return this.states[6*t+i]}stateFlag(t,i){return(this.stateSlot(t,0)&i)>0}findNested(t){let i=this.stateSlot(t,0);return 4&i?this.nested[i>>10]:null}validAction(t,i){if(i==this.stateSlot(t,4))return!0;for(let s=this.stateSlot(t,1);;s+=3){if(65535==this.data[s]){if(1!=this.data[s+1])return!1;s=R(this.data,s+2)}if(i==R(this.data,s+1))return!0}}nextStates(t){let i=[];for(let s=this.stateSlot(t,1);;s+=3){if(65535==this.data[s]){if(1!=this.data[s+1])break;s=R(this.data,s+2)}if(0==(1&this.data[s+2])){let t=this.data[s+1];i.some(((i,s)=>1&s&&i==t))||i.push(this.data[s],t)}}return i}overrides(t,i){let s=j(this.data,this.tokenPrecTable,i);return s<0||j(this.data,this.tokenPrecTable,t)<s}configure(t){let i=Object.assign(Object.create(M.prototype),this);if(t.props&&(i.nodeSet=this.nodeSet.extend(...t.props)),t.top){let s=this.topRules[t.top];if(!s)throw new RangeError(`Invalid top rule name ${t.top}`);i.top=s}return t.tokenizers&&(i.tokenizers=this.tokenizers.map((i=>{let s=t.tokenizers.find((t=>t.from==i));return s?s.to:i}))),t.dialect&&(i.dialect=this.parseDialect(t.dialect)),t.nested&&(i.nested=this.nested.map((i=>Object.prototype.hasOwnProperty.call(t.nested,i.name)?{name:i.name,value:t.nested[i.name],end:i.end,placeholder:i.placeholder}:i))),null!=t.strict&&(i.strict=t.strict),null!=t.bufferLength&&(i.bufferLength=t.bufferLength),i}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get hasNested(){return this.nested.length>0}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let i=this.dynamicPrecedences;return null==i?0:i[t]||0}parseDialect(t){if(this.cachedDialect&&this.cachedDialect.source==t)return this.cachedDialect;let i=Object.keys(this.dialects),s=i.map((()=>!1));if(t)for(let h of t.split(" ")){let t=i.indexOf(h);t>=0&&(s[t]=!0)}let e=null;for(let h=0;h<i.length;h++)if(!s[h])for(let t,s=this.dialects[i[h]];65535!=(t=this.data[s++]);)(e||(e=new Uint8Array(this.maxTerm+1)))[t]=1;return this.cachedDialect=new $(t,s,e)}static deserialize(t){return new M(t)}}function R(t,i){return t[i]|t[i+1]<<16}function j(t,i,s){for(let e,h=i;65535!=(e=t[h]);h++)if(e==s)return h-i;return-1}export{D as C,d as E,M as P}